id: CVE-2020-9496
info:
  name: Apache OFBiz XSS
  risk: Medium

params:
  - root: '{{.BaseURL}}'

requests: 
  - method: POST
    url: >-
      {{.root}}/webtools/control/xmlrpc
    headers:
      - User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3984.0 Safari/537.36
      - Origin: http://{{.Host}}
      - Content-Type: application/xml
    data: <?xml version="1.0"?><methodCall><methodName>JAELES</methodName><params><param><value>cvebase</value></param></params></methodCall>
    detections:
      - >-
        StatusCode() == 200 && StringSearch("resHeaders", "Content-Type: text/xml") && StringSearch("resBody", "No such service [JAELES]") && StringSearch("resBody", "faultString") && StringSearch("resBody", "methodResponse")

references:
  - https://www.cvebase.com/cve/2020/9496
